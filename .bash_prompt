#!/usr/bin/env bash

source ~/.git-prompt.sh

function __git_remote {
    printf_format="${1}"
    remote="$(git status -sb 2> /dev/null | grep '##' | sed 's/.*\.\.\.//' | sed 's/\/.*//')"

    if [ ! -z "$remote" ]; then
        printf -- "$printf_format" "$remote"
    fi
}

function set_ps1 {
    local r="\[\e[0m\]"
    local bold="\[\e[1m\]"
    local dim="\[\e[2m\]"
    local underline="\[\e[4m\]"

    local black="\[\e[30m\]"
    local red="\[\e[31m\]"
    local green="\[\e[32m\]"
    local yellow="\[\e[33m\]"
    local blue="\[\e[34m\]"
    local magenta="\[\e[35m\]"
    local cyan="\[\e[36m\]"
    local light_grey="\[\e[37m\]"
    local dark_grey="\[\e[90m\]"
    local light_red="\[\e[91m\]"
    local light_green="\[\e[92m\]"
    local light_yellow="\[\e[93m\]"
    local light_blue="\[\e[94m\]"
    local light_magenta="\[\e[95m\]"
    local light_cyan="\[\e[96m\]"
    local white="\[\e[97m\]"

    PS1="${blue}\\w"

    # PS1+="\$(__git_remote ' ${dark_grey}[$yellow-${dark_grey}%s$yellow+${dark_grey}]$r')"
    PS1+="\$(__git_remote ' ${dark_grey}[$yellow%s${dark_grey}%s$yellow%s${dark_grey}]$r')"
    PS1+="\$(__git_branch ' ${dark_grey} $dark_grey[$magenta%s$dark_grey]$r ${dark_grey}[$light_red-$green+$blue∙$dark_grey|$light_red-$green+$blue∙${dark_grey}]$r')"

    if is_linux; then
        PS1+="\n"
    elif is_msys; then
        PS1+="\012"
    fi
    PS1+="${dark_grey}$ ${r}"
}

set_ps1
